var w=Symbol("u8"),D=Symbol("i8"),z=Symbol("u16"),A=Symbol("i16"),c=Symbol("u32"),S=Symbol("i32"),v=Symbol("f32"),b=Symbol("f64"),f=e=>(t=[])=>Object.defineProperty(t,e,{value:!0,enumerable:!1,writable:!1,configurable:!1}),x=f(w),B=f(D),$=f(z),O=f(A),P=f(c),F=f(S),W=f(v),j=f(b),h={[w]:(e,t,a)=>(e.setUint8(t,a),1),[D]:(e,t,a)=>(e.setInt8(t,a),1),[z]:(e,t,a)=>(e.setUint16(t,a),2),[A]:(e,t,a)=>(e.setInt16(t,a),2),[c]:(e,t,a)=>(e.setUint32(t,a),4),[S]:(e,t,a)=>(e.setInt32(t,a),4),[v]:(e,t,a)=>(e.setFloat32(t,a),4),[b]:(e,t,a)=>(e.setFloat64(t,a),8)},U={[w]:(e,t)=>({value:e.getUint8(t),size:1}),[D]:(e,t)=>({value:e.getInt8(t),size:1}),[z]:(e,t)=>({value:e.getUint16(t),size:2}),[A]:(e,t)=>({value:e.getInt16(t),size:2}),[c]:(e,t)=>({value:e.getUint32(t),size:4}),[S]:(e,t)=>({value:e.getInt32(t),size:4}),[v]:(e,t)=>({value:e.getFloat32(t),size:4}),[b]:(e,t)=>({value:e.getFloat64(t),size:8})},M=e=>{let t=Object.keys(e),u=t.map(r=>{let n=e[r];for(let o of[w,D,z,A,c,S,v,b])if(o in n)return o;return b}).map(r=>h[r]||(()=>{throw new Error("Unsupported or unannotated type")}));return(r,n,o)=>{let i=0;i+=h[c](r,n+i,o);for(let s=0;s<t.length;s++)i+=u[s](r,n+i,e[t[s]][o]);return i}},T=e=>{let t=Object.keys(e),u=t.map(r=>{let n=e[r];for(let o of[w,D,z,A,c,S,v,b])if(o in n)return o;return b}).map(r=>U[r]||(()=>{throw new Error("Unsupported or unannotated type")}));return(r,n,o)=>{let i=0,{value:s,size:m}=U[c](r,n+i);i+=m;let l=o?o.get(s)??s:s;for(let p=0;p<t.length;p++){let{value:d,size:y}=u[p](r,n+i);e[t[p]][l]=d,i+=y}return i}},C=(e,t=new ArrayBuffer(1024*1024*100))=>{let a=new DataView(t),u=e.map(M);return r=>{let n=0;for(let o=0;o<r.length;o++){let i=r[o];for(let s=0;s<u.length;s++)n+=u[s](a,n,i)}return t.slice(0,n)}},V=e=>{let t=e.map(T);return(a,u)=>{let r=new DataView(a),n=0;for(;n<a.byteLength;)for(let o=0;o<t.length;o++)n+=t[o](r,n,u)}};import{addComponent as L,hasComponent as G,getAllEntities as k,addEntity as q}from"../core";var H=(e,t,a=new ArrayBuffer(1024*1024*100))=>{let u=new DataView(a),r=0,n=i=>{let s=i.length;u.setUint32(r,s),r+=4;for(let m=0;m<s;m++){let l=i[m],p=0;u.setUint32(r,l),r+=4;let d=r;r+=1;for(let y=0;y<t.length;y++)G(e,l,t[y])&&(u.setUint8(r,y),r+=1,p++);u.setUint8(d,p)}},o=i=>{let m=C(t,a.slice(r))(i);new Uint8Array(a).set(new Uint8Array(m),r),r+=m.byteLength};return()=>{r=0;let i=k(e);return n(i),o(i),a.slice(0,r)}},J=(e,t)=>{let a=V(t);return u=>{let r=new DataView(u),n=0,o=new Map,i=r.getUint32(n);n+=4;for(let s=0;s<i;s++){let m=r.getUint32(n);n+=4;let l=q(e);o.set(m,l);let p=r.getUint8(n);n+=1;for(let d=0;d<p;d++){let y=r.getUint8(n);n+=1,L(e,l,t[y])}}return a(u.slice(n),o),o}};import{addComponent as E,removeComponent as K,addEntity as N,removeEntity as Q,observe as g,onAdd as I,onRemove as R}from"../core";var X=(e,t,a,u=new ArrayBuffer(1024*1024*100))=>{let r=new DataView(u),n=0,o=[];return g(e,I(t),i=>{o.push([i,0,-1])}),g(e,R(t),i=>{o.push([i,1,-1])}),a.forEach((i,s)=>{g(e,I(t,i),m=>{o.push([m,2,s])}),g(e,R(t,i),m=>{o.push([m,3,s])})}),()=>{n=0;for(let i=0;i<o.length;i++){let[s,m,l]=o[i];r.setUint32(n,s),n+=4,r.setUint8(n,m),n+=1,r.setUint8(n,l),n+=1}return o.length=0,u.slice(0,n)}},Y=(e,t,a)=>(u,r=new Map)=>{let n=new DataView(u),o=0;for(;o<u.byteLength;){let i=n.getUint32(o);o+=4;let s=n.getUint8(o);o+=1;let m=n.getUint8(o);o+=1;let l=a[m],p=r.get(i);p===void 0&&(p=N(e),r.set(i,p)),s===0?E(e,p,t):s===1?Q(e,p):s===2?E(e,p,l):s===3&&K(e,p,l)}return r};export{Y as createObserverDeserializer,X as createObserverSerializer,J as createSnapshotDeserializer,H as createSnapshotSerializer,V as createSoADeserializer,C as createSoASerializer,W as f32,j as f64,O as i16,F as i32,B as i8,$ as u16,P as u32,x as u8};
//# sourceMappingURL=index.min.mjs.map
